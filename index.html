<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coins & Diamonds</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Fredoka One', cursive;
            background: linear-gradient(135deg, #2c1810 0%, #4a3020 50%, #2c1810 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .auth-buttons {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            gap: 20px;
        }

        .auth-buttons.hidden {
            display: none;
        }

        .auth-btn {
            font-family: 'Fredoka One', cursive;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        }

        .auth-btn:hover {
            transform: scale(1.05);
        }

        .login-btn {
            background: #4CAF50;
            color: white;
            border: 3px solid #2d7a2f;
        }

        .signup-btn {
            background: #2196F3;
            color: white;
            border: 3px solid #1565C0;
        }

        .logout-btn {
            background: #f44336;
            color: white;
            border: 3px solid #c62828;
            min-width: 90px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #3d2817;
            padding: clamp(25px, 3vh, 30px) clamp(30px, 4vw, 40px);
            border-radius: clamp(12px, 1.5vw, 15px);
            text-align: center;
            width: 90%;
            max-width: 400px;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .modal-content h2 {
            color: #DAA520;
            margin-bottom: clamp(15px, 2vh, 20px);
            text-shadow: 0 0 15px rgba(218, 165, 32, 0.6);
        }

        .modal-content input {
            font-family: 'Fredoka One', cursive;
            width: 100%;
            padding: clamp(10px, 1.5vh, 12px);
            margin: clamp(8px, 1vh, 10px) 0;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            border-radius: clamp(6px, 0.8vw, 8px);
            font-size: clamp(14px, 1.8vw, 16px);
            background: #2c1810;
            color: #fff;
        }

        .modal-content button {
            font-family: 'Fredoka One', cursive;
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            border: 3px solid;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .modal-content button:hover {
            transform: scale(1.05);
        }

        .submit-btn {
            background: #4CAF50;
            color: white;
            border-color: #2d7a2f;
        }

        .cancel-btn {
            background: #f44336;
            color: white;
            border-color: #c62828;
        }

        .container {
            text-align: center;
        }

        /* Welcome Title - Positioned to not overlap stats */
        .welcome-title {
            position: absolute;
            top: clamp(18px, 2.5vh, 25px);
            left: 50%;
            transform: translateX(-50%);
            color: #DAA520;
            font-size: clamp(18px, 2.5vw, 26px);
            text-shadow: 0 0 20px rgba(218, 165, 32, 0.6), 2px 2px 4px rgba(0, 0, 0, 0.5);
            white-space: nowrap;
            max-width: calc(100% - 260px);
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
            padding: 0 10px;
        }

        /* Player Info Frame - Positioned below logout/add buttons */
        .player-info-frame {
            position: absolute;
            top: clamp(65px, 9vh, 75px);
            left: clamp(10px, 2vw, 20px);
            right: clamp(10px, 2vw, 20px);
            background: #3d2817;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            border-radius: clamp(10px, 1.5vw, 15px);
            padding: clamp(10px, 1.5vw, 15px) clamp(15px, 2vw, 25px);
            display: flex;
            align-items: center;
            gap: clamp(15px, 2vw, 30px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
        }

        .player-details {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: clamp(3px, 0.5vh, 5px);
        }

        .player-name {
            color: #fff;
            font-size: clamp(16px, 2vw, 20px);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
        }

        .player-level {
            color: #FFD700;
            font-size: clamp(14px, 1.5vw, 16px);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .player-resources {
            display: flex;
            flex-direction: column;
            gap: clamp(3px, 0.5vh, 5px);
            margin-left: auto;
        }

        .resource-row {
            display: flex;
            align-items: center;
            gap: clamp(3px, 0.5vw, 5px);
            font-size: clamp(14px, 1.8vw, 18px);
        }

        .resource-label {
            color: #fff;
            min-width: clamp(60px, 8vw, 80px);
        }

        .coins-amount {
            color: #DAA520;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
            min-width: clamp(40px, 6vw, 60px);
        }

        .diamonds-amount {
            color: #00FFFF;
            text-shadow: 0 0 8px #00FFFF, 2px 2px 4px rgba(0, 0, 0, 0.4);
            min-width: clamp(40px, 6vw, 60px);
        }

        /* Notification Frame - Properly spaced below stats */
        .notification-frame {
            position: absolute;
            top: clamp(145px, 19vh, 165px);
            left: clamp(10px, 2vw, 20px);
            right: clamp(10px, 2vw, 20px);
            background: #3d2817;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            border-radius: clamp(10px, 1.5vw, 15px);
            padding: clamp(8px, 1vh, 12px) clamp(10px, 1.5vw, 15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
            overflow: hidden;
            height: clamp(35px, 5vh, 45px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-text {
            color: white;
            font-size: clamp(14px, 1.8vw, 18px);
            white-space: nowrap;
            opacity: 0;
            transform: translateX(0);
            transition: opacity 0.5s ease;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        .notification-text.show {
            opacity: 1;
            animation: fadeInOut 4.5s ease-in-out;
        }

        @keyframes fadeInOut {
            0% {
                opacity: 0;
            }
            11% {
                opacity: 1;
            }
            56% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        .gold-text {
            color: #DAA520;
            text-shadow: 0 0 10px rgba(218, 165, 32, 0.8), 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Daily Box Frame - Properly spaced below notification */
        .daily-box-frame {
            position: absolute;
            top: clamp(210px, 30vh, 240px);
            left: clamp(10px, 2vw, 20px);
            right: 52%;
            background: #3d2817;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            border-radius: clamp(10px, 1.5vw, 15px);
            padding: clamp(15px, 2vh, 20px) clamp(20px, 2.5vw, 30px);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(10px, 1.5vh, 15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
        }

        .hourly-box-frame {
            position: absolute;
            top: clamp(210px, 30vh, 240px);
            left: 52%;
            right: clamp(10px, 2vw, 20px);
            background: #3d2817;
            border: clamp(2px, 0.3vw, 3px) solid #6b5a47;
            border-radius: clamp(10px, 1.5vw, 15px);
            padding: clamp(15px, 2vh, 20px) clamp(20px, 2.5vw, 30px);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(10px, 1.5vh, 15px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);
        }

        .box-title {
            color: #fff;
            font-size: clamp(18px, 2.5vw, 24px);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
        }

        .box-btn {
            font-family: 'Fredoka One', cursive;
            border: clamp(2px, 0.3vw, 3px) solid;
            color: white;
            padding: clamp(10px, 1.5vh, 12px) clamp(20px, 2.5vw, 30px);
            border-radius: clamp(8px, 1vw, 10px);
            font-size: clamp(14px, 1.8vw, 18px);
            cursor: pointer;
            transition: all 0.3s;
            min-width: clamp(150px, 20vw, 200px);
            text-align: center;
        }

        .box-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .box-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .daily-box-btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            border-color: #0D47A1;
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.6);
        }

        .daily-box-btn:hover:not(:disabled) {
            box-shadow: 0 0 30px rgba(33, 150, 243, 0.8);
        }

        .hourly-box-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            border-color: #c62828;
            box-shadow: 0 0 20px rgba(244, 67, 54, 0.6);
        }

        .hourly-box-btn:hover:not(:disabled) {
            box-shadow: 0 0 30px rgba(244, 67, 54, 0.8);
        }

        .box-timer {
            display: none;
        }

        .plus-btn {
            font-family: 'Fredoka One', cursive;
            background: linear-gradient(135deg, #f44336, #d32f2f);
            border: 3px solid #c62828;
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.5), 0 0 30px rgba(244, 67, 54, 0.4);
            position: absolute;
            top: 20px;
            right: 20px;
            min-width: 90px;
        }

        .plus-btn:hover {
            background: linear-gradient(135deg, #e53935, #c62828);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.7), 0 0 40px rgba(244, 67, 54, 0.6);
        }

        .admin-panel {
            background: linear-gradient(135deg, #3d2817, #2c1810);
            padding: clamp(20px, 3vh, 30px);
            border-radius: clamp(15px, 2vw, 20px);
            border: clamp(3px, 0.4vw, 4px) solid #8b7355;
            margin-top: clamp(15px, 2vh, 20px);
            box-shadow: 0 0 40px rgba(139, 115, 85, 0.4), 0 8px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            max-width: clamp(400px, 50vw, 500px);
            width: 90%;
            margin-left: auto;
            margin-right: auto;
        }

        .admin-panel::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #8b7355, #6b5a47, #8b7355, #6b5a47);
            border-radius: clamp(15px, 2vw, 20px);
            z-index: -1;
            opacity: 0.5;
            filter: blur(10px);
        }

        .admin-panel h3 {
            color: #DAA520;
            margin-bottom: clamp(15px, 2vh, 20px);
            font-size: clamp(22px, 3vw, 28px);
            text-shadow: 0 0 20px rgba(218, 165, 32, 0.8), 2px 2px 4px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        .admin-input-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(10px, 1.5vw, 15px);
            margin: clamp(10px, 1.5vh, 15px) 0;
        }

        .admin-input-label {
            color: #fff;
            font-size: clamp(16px, 2vw, 18px);
            min-width: clamp(80px, 10vw, 100px);
            text-align: right;
        }

        .admin-input {
            font-family: 'Fredoka One', cursive;
            width: clamp(120px, 15vw, 150px);
            padding: clamp(10px, 1.5vh, 12px);
            border: clamp(2px, 0.3vw, 3px) solid #8b7355;
            border-radius: clamp(8px, 1vw, 10px);
            font-size: clamp(14px, 1.8vw, 16px);
            background: #2c1810;
            color: #fff;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        .admin-input:focus {
            outline: none;
            border-color: #DAA520;
            box-shadow: 0 0 15px rgba(218, 165, 32, 0.5);
        }

        .admin-add-btn {
            font-family: 'Fredoka One', cursive;
            padding: clamp(12px, 1.8vh, 15px) clamp(30px, 4vw, 40px);
            margin-top: clamp(15px, 2vh, 20px);
            border: clamp(2px, 0.3vw, 3px) solid #2d7a2f;
            border-radius: clamp(10px, 1.2vw, 12px);
            cursor: pointer;
            font-size: clamp(16px, 2vw, 20px);
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.5);
            transition: all 0.3s;
        }

        .admin-add-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 25px rgba(76, 175, 80, 0.7);
        }

        .notification {
            display: none;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="auth-buttons" id="authButtons">
        <button class="auth-btn login-btn" onclick="showLogin()">Login</button>
        <button class="auth-btn signup-btn" onclick="showSignup()">Sign Up</button>
    </div>

    <!-- Welcome Title -->
    <div class="welcome-title hidden" id="welcomeTitle">Welcome, Player!</div>

    <!-- Player Info Frame -->
    <div class="player-info-frame hidden" id="playerInfoFrame">
        <div class="player-details">
            <div class="player-name" id="playerNameDisplay">Player</div>
            <div class="player-level" id="playerLevelDisplay">Level 1</div>
        </div>
        <div class="player-resources">
            <div class="resource-row">
                <span class="resource-label">ðŸ’°: </span>
                <span class="coins-amount" id="coinsDisplay">0</span>
            </div>
            <div class="resource-row">
                <span class="resource-label">ðŸ’Ž: </span>
                <span class="diamonds-amount" id="diamondsDisplay">0</span>
            </div>
        </div>
    </div>

    <!-- Notification Frame -->
    <div class="notification-frame hidden" id="notificationFrame">
        <div class="notification-text" id="notificationText"></div>
    </div>

    <!-- Daily Box Frame -->
    <div class="daily-box-frame hidden" id="dailyBoxFrame">
        <div class="box-title">Daily Box</div>
        <button class="box-btn daily-box-btn" id="dailyBoxBtn" onclick="openDailyBox()">Open</button>
    </div>

    <!-- Hourly Box Frame -->
    <div class="hourly-box-frame hidden" id="hourlyBoxFrame">
        <div class="box-title">Hourly Box</div>
        <button class="box-btn hourly-box-btn" id="hourlyBoxBtn" onclick="openHourlyBox()">Open</button>
    </div>

    <button class="plus-btn hidden" id="addBtn" onclick="showAdminPrompt()">Add</button>

    <button class="auth-btn logout-btn hidden" id="logoutBtn" onclick="logout()" style="position: absolute; top: 20px; left: 20px;">Logout</button>

    <div class="notification" id="notification">Here's your reward! :)</div>
    <div class="notification" id="dailyBoxNotification"></div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>Login</h2>
            <input type="text" id="loginUsername" placeholder="Username">
            <input type="password" id="loginPassword" placeholder="Password">
            <button class="submit-btn" onclick="login()">Login</button>
            <button class="cancel-btn" onclick="closeModal('loginModal')">Cancel</button>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <h2>Sign Up</h2>
            <input type="text" id="signupUsername" placeholder="Username">
            <input type="password" id="signupPassword" placeholder="Password">
            <button class="submit-btn" onclick="signup()">Create Account</button>
            <button class="cancel-btn" onclick="closeModal('signupModal')">Cancel</button>
        </div>
    </div>

    <!-- Admin Code Modal -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <h2>Admin Access</h2>
            <input type="password" id="adminCode" placeholder="Enter Admin Code">
            <button class="submit-btn" onclick="verifyAdmin()">Submit</button>
            <button class="cancel-btn" onclick="closeModal('adminModal')">Cancel</button>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal" id="adminPanelModal">
        <div class="modal-content">
            <div class="admin-panel">
                <h3>âœ¨ Admin Panel âœ¨</h3>
                <div class="admin-input-group">
                    <span class="admin-input-label">ðŸ’° Coins:</span>
                    <input type="number" id="addCoinsInput" class="admin-input" placeholder="0" value="0">
                </div>
                <div class="admin-input-group">
                    <span class="admin-input-label">ðŸ’Ž Diamonds:</span>
                    <input type="number" id="addDiamondsInput" class="admin-input" placeholder="0" value="0">
                </div>
                <button class="admin-add-btn" onclick="addAllCurrency()">Add All</button>
            </div>
            <button class="cancel-btn" style="margin-top: 15px;" onclick="closeModal('adminPanelModal')">Close</button>
        </div>
    </div>

    <script>
        const ADMIN_CODE = "admin123";
        let currentUser = null;
        let animating = false;

        // Load user from localStorage
        function loadUser() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                const users = JSON.parse(localStorage.getItem('users') || '{}');
                if (users[savedUser]) {
                    currentUser = savedUser;
                    showMainApp();
                    loadStats();
                }
            }
        }

        function showLogin() {
            document.getElementById('loginModal').classList.add('active');
        }

        function showSignup() {
            document.getElementById('signupModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                alert('Please fill in all fields');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                localStorage.setItem('currentUser', username);
                closeModal('loginModal');
                showMainApp();
                loadStats();
            } else {
                alert('Invalid username or password');
            }
        }

        function signup() {
            const username = document.getElementById('signupUsername').value;
            const password = document.getElementById('signupPassword').value;

            if (!username || !password) {
                alert('Please fill in all fields');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (users[username]) {
                alert('Username already exists');
                return;
            }

            users[username] = {
                password: password,
                coins: 0,
                diamonds: 0,
                level: 1
            };

            localStorage.setItem('users', JSON.stringify(users));
            currentUser = username;
            localStorage.setItem('currentUser', username);
            closeModal('signupModal');
            showMainApp();
            loadStats();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('authButtons').classList.remove('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
            document.getElementById('addBtn').classList.add('hidden');
            document.getElementById('playerInfoFrame').classList.add('hidden');
            document.getElementById('notificationFrame').classList.add('hidden');
            document.getElementById('dailyBoxFrame').classList.add('hidden');
            document.getElementById('hourlyBoxFrame').classList.add('hidden');
            document.getElementById('welcomeTitle').classList.add('hidden');
            if (window.timerInterval) {
                clearInterval(window.timerInterval);
            }
        }

        function showMainApp() {
            document.getElementById('authButtons').classList.add('hidden');
            document.getElementById('logoutBtn').classList.remove('hidden');
            document.getElementById('addBtn').classList.remove('hidden');
            document.getElementById('playerInfoFrame').classList.remove('hidden');
            document.getElementById('notificationFrame').classList.remove('hidden');
            document.getElementById('dailyBoxFrame').classList.remove('hidden');
            document.getElementById('hourlyBoxFrame').classList.remove('hidden');
            document.getElementById('welcomeTitle').classList.remove('hidden');
            document.getElementById('welcomeTitle').textContent = `Welcome, ${currentUser}!`;
            document.getElementById('playerNameDisplay').textContent = currentUser;
            checkBoxTimers();
            startTimerUpdates();
        }

        function loadStats() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser]) {
                document.getElementById('coinsDisplay').textContent = users[currentUser].coins || 0;
                document.getElementById('diamondsDisplay').textContent = users[currentUser].diamonds || 0;
                document.getElementById('playerLevelDisplay').textContent = `Level ${users[currentUser].level || 1}`;
            }
        }

        function saveStats() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[currentUser]) {
                const coins = parseInt(document.getElementById('coinsDisplay').textContent);
                const diamonds = parseInt(document.getElementById('diamondsDisplay').textContent);
                users[currentUser].coins = coins;
                users[currentUser].diamonds = diamonds;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        function showAdminPrompt() {
            document.getElementById('adminModal').classList.add('active');
        }

        function verifyAdmin() {
            const code = document.getElementById('adminCode').value;
            if (code === ADMIN_CODE) {
                closeModal('adminModal');
                document.getElementById('adminCode').value = '';
                document.getElementById('adminPanelModal').classList.add('active');
            } else {
                alert('Incorrect admin code');
            }
        }

        function animateNumber(elementId, start, end, baseDuration) {
            const element = document.getElementById(elementId);
            const range = Math.abs(end - start);
            
            // Adjust duration based on amount - more change = faster per unit
            let duration = baseDuration;
            if (range < 100) {
                duration = 1000; // Fast for small amounts
            } else if (range < 1000) {
                duration = 1500;
            } else if (range < 5000) {
                duration = 2000;
            } else {
                duration = 2500; // Slower for very large amounts
            }
            
            const startTime = Date.now();
            
            const animate = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Ease out cubic - fast at start, slow at end
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                
                const current = start + (end - start) * easeProgress;
                element.textContent = Math.round(current);
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    element.textContent = end; // Ensure final value is exact
                }
            };
            
            requestAnimationFrame(animate);
        }

        function addAllCurrency() {
            const coinsAmount = parseInt(document.getElementById('addCoinsInput').value) || 0;
            const diamondsAmount = parseInt(document.getElementById('addDiamondsInput').value) || 0;

            const currentCoins = parseInt(document.getElementById('coinsDisplay').textContent);
            const currentDiamonds = parseInt(document.getElementById('diamondsDisplay').textContent);

            closeModal('adminPanelModal');
            document.getElementById('addCoinsInput').value = '0';
            document.getElementById('addDiamondsInput').value = '0';

            // Show notification
            const notification = document.getElementById('notification');
            notification.classList.add('show');

            // Animate after 3 seconds
            setTimeout(() => {
                if (coinsAmount >= 0) {
                    animateNumber('coinsDisplay', currentCoins, coinsAmount, 2000);
                }
                if (diamondsAmount >= 0) {
                    animateNumber('diamondsDisplay', currentDiamonds, diamondsAmount, 2000);
                }
                
                // Save stats after animation completes
                setTimeout(() => {
                    saveStats();
                }, 2100);
                
                // Hide notification after staying visible for 3 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }, 0);
        }

        function showNotification(message) {
            const notificationText = document.getElementById('notificationText');
            
            // Replace "GOLD" with styled span
            const styledMessage = message.replace(/(\d+) GOLD/g, '$1 <span class="gold-text">GOLD</span>');
            notificationText.innerHTML = styledMessage;
            
            // Remove any existing animation
            notificationText.classList.remove('show');
            
            // Trigger reflow to restart animation
            void notificationText.offsetWidth;
            
            // Start animation
            setTimeout(() => {
                notificationText.classList.add('show');
            }, 10);
            
            // Remove after animation completes (4.5 seconds)
            setTimeout(() => {
                notificationText.classList.remove('show');
            }, 4500);
        }

        function openDailyBox() {
            // Generate random gold amount between 250 and 2000
            const randomGold = Math.floor(Math.random() * 1751) + 250;
            
            const currentCoins = parseInt(document.getElementById('coinsDisplay').textContent);
            const newCoins = currentCoins + randomGold;
            
            // Save the claim time
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            users[currentUser].dailyBoxClaimed = Date.now();
            localStorage.setItem('users', JSON.stringify(users));
            
            // Disable button and show timer
            const btn = document.getElementById('dailyBoxBtn');
            btn.disabled = true;
            
            // Show notification
            showNotification(`Received ${randomGold} GOLD from Daily Box!`);
            
            // Animate coins
            animateNumber('coinsDisplay', currentCoins, newCoins, 2000);
            
            // Save stats after animation completes
            setTimeout(() => {
                saveStats();
            }, 2100);
        }

        function openHourlyBox() {
            // Generate random gold amount between 10 and 250
            const randomGold = Math.floor(Math.random() * 241) + 10;
            
            const currentCoins = parseInt(document.getElementById('coinsDisplay').textContent);
            const newCoins = currentCoins + randomGold;
            
            // Save the claim time
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            users[currentUser].hourlyBoxClaimed = Date.now();
            localStorage.setItem('users', JSON.stringify(users));
            
            // Disable button and show timer
            const btn = document.getElementById('hourlyBoxBtn');
            btn.disabled = true;
            
            // Show notification
            showNotification(`Received ${randomGold} GOLD from Hourly Box!`);
            
            // Animate coins
            animateNumber('coinsDisplay', currentCoins, newCoins, 2000);
            
            // Save stats after animation completes
            setTimeout(() => {
                saveStats();
            }, 2100);
        }

        function checkBoxTimers() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (!users[currentUser]) return;
            
            const now = Date.now();
            const dailyBoxClaimed = users[currentUser].dailyBoxClaimed || 0;
            const hourlyBoxClaimed = users[currentUser].hourlyBoxClaimed || 0;
            
            const dailyBoxBtn = document.getElementById('dailyBoxBtn');
            const hourlyBoxBtn = document.getElementById('hourlyBoxBtn');
            
            // Check daily box (12 hours = 43200000 ms)
            const dailyTimePassed = now - dailyBoxClaimed;
            if (dailyTimePassed < 43200000) {
                dailyBoxBtn.disabled = true;
            } else {
                dailyBoxBtn.disabled = false;
                dailyBoxBtn.textContent = 'Open';
            }
            
            // Check hourly box (1 hour = 3600000 ms)
            const hourlyTimePassed = now - hourlyBoxClaimed;
            if (hourlyTimePassed < 3600000) {
                hourlyBoxBtn.disabled = true;
            } else {
                hourlyBoxBtn.disabled = false;
                hourlyBoxBtn.textContent = 'Open';
            }
        }

        function updateTimerDisplays() {
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (!users[currentUser]) return;
            
            const now = Date.now();
            const dailyBoxClaimed = users[currentUser].dailyBoxClaimed || 0;
            const hourlyBoxClaimed = users[currentUser].hourlyBoxClaimed || 0;
            
            const dailyBoxBtn = document.getElementById('dailyBoxBtn');
            const hourlyBoxBtn = document.getElementById('hourlyBoxBtn');
            
            // Update daily box timer
            const dailyTimePassed = now - dailyBoxClaimed;
            const dailyTimeRemaining = 43200000 - dailyTimePassed; // 12 hours
            if (dailyTimeRemaining > 0) {
                const hours = Math.floor(dailyTimeRemaining / 3600000);
                const minutes = Math.floor((dailyTimeRemaining % 3600000) / 60000);
                const seconds = Math.floor((dailyTimeRemaining % 60000) / 1000);
                dailyBoxBtn.textContent = `${hours}hr ${String(minutes).padStart(2, '0')}m ${String(seconds).padStart(2, '0')}s`;
            } else {
                checkBoxTimers(); // Re-enable button
            }
            
            // Update hourly box timer
            const hourlyTimeRemaining = 3600000 - (now - hourlyBoxClaimed); // 1 hour
            if (hourlyTimeRemaining > 0) {
                const hours = Math.floor(hourlyTimeRemaining / 3600000);
                const minutes = Math.floor((hourlyTimeRemaining % 3600000) / 60000);
                const seconds = Math.floor((hourlyTimeRemaining % 60000) / 1000);
                hourlyBoxBtn.textContent = `${hours}hr ${String(minutes).padStart(2, '0')}m ${String(seconds).padStart(2, '0')}s`;
            } else {
                checkBoxTimers(); // Re-enable button
            }
        }

        function startTimerUpdates() {
            // Update timers every second
            window.timerInterval = setInterval(updateTimerDisplays, 1000);
        }

        // Load user on page load
        loadUser();
    </script>
</body>
</html>
